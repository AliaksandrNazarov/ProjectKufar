{"version":3,"sources":["webpack://Dzi/webpack/bootstrap","webpack://Dzi/./lib/index.js"],"names":["launch","bootstrap","COUNTER","doc","window","document","REGISTRY","Map","register","ctor","Object","assign","name","NAME","exec","toString","text","TEMPLATE","prototype","getElementById","innerText","compiled","compile","parseXML","$TEMPLATE","resolve","$","set","types","body","render","elt","length","Application","forEach","staticTypes","concat","getElementsByTagName","filter","e","id","has","type","map","Bootstrap","$elt","meta","props","subs","requestAnimationFrame","values","setters","k","v","textContent","disabled","class","replace","_","cl","fl","hasEq","eq","indexOf","setAttribute","selected","value","checked","data","$dataset","slice","key","setListener","ev","keyCode","$attributes","call","$owner","blur","Elmnt","m","parentElt","tag","createTextNode","createElement","owner","lstnrs","$listeners","keys","removeEventListener","p","parentElement","removeChild","delta","isDone","transclude","cursor","applyAttributes","before","nextSibling","firstChild","appendChild","insertBefore","theirs","mines","hasOwnProperty","undefined","prefixP","setter","listeners","T","removeAttribute","fn","addEventListener","get","delete","Component","C","d","init","$defered","done","app","unsubscribe","$assignDepth","their","mine","toUpperCase","prevElt","constructor","posE","getter","posB","children","c","uid","size","ch","entries","Ctor","parent","isInited","cc","Array","isArray","reduce","iff","each","else","partial","a","f","dataGetter","split","index","itemId","r","s","compileType","dtype","attrs","compileAttrs","aIf","ifElse","find","ifThen","aEach","dataId","res","RE_SINGLE_PLACEHOLDER","RE_PLACEHOLDER","aProps","push","ref","fctr","compileAttrValue","trim","old","url","ckey","cbusy","cerror","counter","cb","error","setTimeout","subscribe","dispatch","includes","match","RE_XML_ENTITY","RE_XML_COMMENT","RE_ATTRS","RE_ESCAPE_XML_ENTITY","RE_XML_TAG","SUBST_XML_ENTITY","amp","gt","lt","quot","nbsp","ESCAPE_XML_ENTITY","FN_ESCAPE_XML_ENTITY","charCodeAt","FN_XML_ENTITY","substring","String","fromCharCode","decodeXmlEntities","escapeXml","UID","parseAttrs","stringifyAttrs","join","Node","stringify","tab","sattrs","ssubs","stext","_s","ctx","lastIndex","addChild","setText","Error","input","Math","max","min","shift","unshift","getChild","notify","result","Promise","then","catch","Store","defaults","R","subscribers","reset","payload","cb0","method","ex","subscriberId","store","createStore","onhash","onhashchange","location","hash"],"mappings":"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","file":"index.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./lib/index.js\");\n","let COUNTER = 1\nconst doc = window.document\n\n// ==========\n// Bootstrap\n// ----------\n\n// type registry\nconst REGISTRY = new Map()\nconst register = ctor => {\n  // narrow non-function ctor\n  ctor = typeof ctor === 'function' ? ctor : Object.assign(function () {}, ctor)\n  // narrow name\n  const name = ctor.NAME ||\n    ctor.name ||\n    (/^function\\s+([\\w$]+)\\s*\\(/.exec(ctor.toString()) || [])[1] || ('$C' + COUNTER++)\n  // narrow template\n  const text = ctor.TEMPLATE ||\n    (ctor.prototype.TEMPLATE && ctor.prototype.TEMPLATE()) ||\n    (doc.getElementById(name) || {innerText: `<noop name=\"${name}\"/>`}).innerText\n  // compile\n  const compiled = compile(parseXML(text))\n  ctor.$TEMPLATE = $ => resolve(new Map(), $, compiled)\n  // register\n  REGISTRY.set(name, ctor)\n}\n\n// bootstap a components tree and render immediately on <body/>\nexport function launch (...types) {\n  bootstrap(window.document.body, ...types).render()\n}\n// bootstap a components tree\nexport function bootstrap (elt, ...types) {\n  if (types.length === 0) {\n    types = [ Application ]\n  }\n  types.forEach(register)\n  // register transparent container: <ui:fragment>\n  register({NAME: 'fragment', TEMPLATE: '<ui:transclude/>'})\n  // collect and register `bare-template` definitions\n  const staticTypes = ([]).concat([...doc.getElementsByTagName('script')])\n    .filter(e => e.id && !REGISTRY.has(e.id) && e.type === 'text/x-template')\n  staticTypes.map(e => ({ NAME: e.id, TEMPLATE: e.innerText }))\n    .forEach(register)\n  // use `<body>` as mount element by default\n  return new Bootstrap(elt || doc.body, types[0])\n}\n\nclass Bootstrap {\n  constructor (elt, ctor) {\n    this.$elt = elt\n    this.meta = new Map()\n    this.meta.set(0, { ctor, props: {}, subs: [] })\n  }\n  render () {\n    window.requestAnimationFrame(() => render(this, this.meta, this.$elt))\n  }\n}\n\n// ==========\n// DOM Element\n// ----------\nconst values = {\n  'true': true,\n  'false': false,\n  'null': null\n}\n\nconst setters = {\n  '#text': (e, k, v) => (e.textContent = v == null ? '' : v),\n  disabled: (e, k, v) => (e[k] = v ? true : null),\n  class: (e, k, v) => {\n    v = ('' + v).replace(/([a-z0-9]+):([a-z0-9.]*)(=([a-z0-9.]*))?\\b/g, (_, cl, fl, hasEq, eq) => {\n      const disabled = hasEq ? fl !== eq : ['', '0', 'false', 'off'].indexOf(fl) > -1\n      return disabled ? '' : cl\n    })\n    e.setAttribute(k, v)\n  },\n  selected: (e, k, v) => (e[k] = v ? true : null),\n  value: (e, k, v) => (e[k] = v),\n  checked: (e, k, v) => (e[k] = !!v),\n  data: (e, k, v) => { e.$dataset = Object.assign({}, v) },\n  'data*': (e, k, v) => { (e.$dataset || (e.$dataset = {}))[k.slice(5)] = v in values ? values[v] : v },\n  'enter': function (e, key, v) {\n    this.setListener('keyup', !v ? null : (ev) => {\n      if (ev.keyCode === 13) {\n        this.$attributes[key].call(this.$owner.$, { value: e.value, ...e.$dataset }, ev)\n      }\n      if (ev.keyCode === 13 || ev.keyCode === 27) {\n        e.blur()\n      }\n      return false\n    })\n  },\n  'toggle': function (e, key, v) {\n    this.setListener('change', !v ? null : (ev) => {\n      this.$attributes[key].call(this.$owner.$, { value: e.checked, ...e.$dataset }, ev)\n      return false\n    })\n  }\n}\n\nclass Elmnt {\n  constructor (m, parentElt) {\n    this.$ = m.tag === '#text' ? doc.createTextNode('') : doc.createElement(m.tag)\n    this.$attributes = {}\n    this.$owner = m.owner\n  }\n  init () {\n  }\n  done () {\n    const e = this.$\n    const lstnrs = this.$listeners\n    if (lstnrs) {\n      Object.keys(lstnrs).forEach(k => e.removeEventListener(k, lstnrs[k]))\n      this.$listeners = null\n    }\n    const p = e.parentElement\n    if (p) {\n      p.removeChild(e)\n    }\n    this.$elt = this.$attributes = this.$owner = this.parentElt = null\n  }\n  assign (delta) {\n    if (this.isDone) {\n      return\n    }\n    const e = this.$\n    const p = this.parentElt\n    if (this.transclude) {\n      e.cursor = null\n      render(this, this.transclude, e)\n      e.cursor = null\n    }\n    this.applyAttributes(delta)\n    const before = p.cursor ? p.cursor.nextSibling : p.firstChild\n    if (!before) {\n      p.appendChild(e)\n    } else if (e !== before) {\n      p.insertBefore(e, before)\n    }\n    p.cursor = e\n  }\n  applyAttributes (theirs) {\n    const e = this.$\n    const mines = this.$attributes\n    for (let key in mines) {\n      if (mines.hasOwnProperty(key) && theirs[key] === undefined) {\n        theirs[key] = null\n      }\n    }\n    for (let key in theirs) {\n      if (theirs.hasOwnProperty(key) && theirs[key] !== mines[key]) {\n        const value = theirs[key]\n        const prefixP = key.indexOf('-')\n        const setter = setters[prefixP === -1 ? key : key.slice(0, prefixP) + '*']\n        if (setter) {\n          setter.call(this, e, key, value)\n        } else {\n          if (typeof value === 'function' || (this.listeners && this.listeners.has(key))) {\n            const T = this\n            this.setListener(key, !value ? null : (ev) => {\n              T.$attributes[key].call(T.$owner.$, {value: e.value, ...e.$dataset}, ev)\n              return false\n            })\n          } else {\n            this.setAttribute(key, value)\n          }\n        }\n      }\n    }\n    this.$attributes = theirs\n  }\n  setAttribute (key, value) {\n    if (value != null) {\n      this.$.setAttribute(key, value)\n    } else {\n      this.$.removeAttribute(key)\n    }\n  }\n  setListener (key, fn) {\n    if (fn) {\n      if (!this.listeners) {\n        this.listeners = new Map()\n      }\n      if (!this.listeners.has(key)) {\n        this.$.addEventListener(key, fn, false)\n        this.listeners.set(key, fn)\n      }\n    } else {\n      if (this.listeners && this.listeners.has(key)) {\n        this.$.removeEventListener(key, this.listeners.get(key))\n        this.listeners.delete(key)\n      }\n    }\n  }\n}\n\n// ==========\n// Component\n// ----------\nclass Component {\n  constructor (m) {\n    const C = m.ctor\n    this.$ = new C()\n    this.$.assign = (d) => this.assign(d)\n  }\n  init () {\n    if (this.$.init) {\n      this.$defered = this.$.init(this)\n    }\n  }\n  done () {\n    if (this.$defered) {\n      this.$defered()\n      this.$defered = null\n    }\n    if (this.$.done) {\n      this.$.done()\n    }\n    if (this.app.unsubscribe) {\n      this.app.unsubscribe(this)\n    }\n  }\n  assign (delta) {\n    if (!delta || this.isDone) {\n      return\n    }\n    // prevent recursive invalidations\n    this.$assignDepth = (this.$assignDepth || 0) + 1\n    if (delta._) {\n      delta = {...delta._, ...delta, _: undefined}\n    }\n    // iterate payload\n    for (let k of Object.keys(delta)) {\n      const their = delta[k]\n      const mine = this.$[k]\n      if (k[0] === '$') {\n        their.call(this)\n        continue\n      }\n      if (their !== undefined && (their !== mine || (typeof their === 'object' && their !== null))) {\n        const setter = this.$['set' + k[0].toUpperCase() + k.slice(1)]\n        if (setter) {\n          setter.call(this.$, their)\n        } else {\n          this.$[k] = their\n        }\n      }\n    }\n    // prevent recursive invalidations\n    --this.$assignDepth\n    if (this.$assignDepth === 0) {\n      this.parentElt.cursor = this.prevElt\n      render(this, this.$.constructor.$TEMPLATE(this), this.parentElt)\n    }\n  }\n  get (k) {\n    let $ = this.$\n    if ($.get) {\n      return $.get(k)\n    }\n    let posE = k.indexOf('.')\n    if (posE === -1) {\n      const getter = $['get' + k[0].toUpperCase() + k.slice(1)]\n      const v = getter ? getter.call($, k) : $[k]\n      if (v === undefined) {\n\n        // throw new Error('No defined property value for ' + $ + k)\n      }\n      return v\n    }\n    let posB = 0\n    while (posE !== -1) {\n      $ = $[k.slice(posB, posE)]\n      if (!$) {\n        return\n      }\n      posB = posE + 1\n      posE = k.indexOf('.', posB)\n    }\n    return $[k.slice(posB)]\n  }\n}\n\n// ==========\n// Rendering\n// ----------\nfunction render ($, meta, parentElt) {\n  if ($.isDone) {\n    return\n  }\n  // done\n  if ($.children) {\n    for (let c of $.children.values()) {\n      if (!meta.has(c.uid)) {\n        done(c)\n      }\n    }\n  }\n  if (meta.size) {\n    const ch = $.children || ($.children = new Map())\n    // create\n    for (let [uid, m] of meta.entries()) {\n      if (!ch.has(uid)) {\n        const Ctor = m.ctor ? Component : Elmnt\n        const c = new Ctor(m)\n        c.uid = uid\n        c.parentElt = parentElt\n        c.parent = $\n        c.app = $.app || c.$\n        ch.set(uid, c)\n      }\n    }\n    // assign\n    for (let [uid, m] of meta.entries()) {\n      const c = ch.get(uid)\n      c.transclude = m.subs\n      c.prevElt = parentElt.cursor\n      c.assign(m.props)\n    }\n    // init\n    for (let c of ch.values()) {\n      if (!c.isInited) {\n        c.isInited = true\n        c.init()\n      }\n    }\n  }\n}\n// done\nfunction done (c) {\n  if (c.isDone) {\n    return\n  }\n  c.isDone = true\n  c.done()\n  if (c.children) {\n    for (let cc of c.children.values()) {\n      done(cc)\n    }\n    c.children = null\n  }\n  if (c.parent) {\n    c.parent.children.delete(c.uid)\n    c.parent = null\n  }\n  if (c.app) {\n    c.app = null\n  }\n}\n\n// ==========\n// Template Resolution\n// ----------\n\nfunction resolve (map, c, meta) {\n  if (!meta) {\n    return map\n  }\n  if (Array.isArray(meta)) {\n    return meta.reduce((m, e) => resolve(m, c, e), map)\n  }\n  const { type, tag, props, subs, uid, iff, each, key } = meta\n  if (iff && !iff(c)) {\n    return resolve(map, c, iff.else)\n  }\n\n  if (tag === 'ui:transclude') {\n    const partial = props.reduce((a, f) => f(c, a), {}).key\n    c.transclude.forEach((v, k) => {\n      if (partial ? v.key === partial : !v.key) {\n        map.set(k, v)\n      }\n    })\n    return map\n  }\n  if (each) {\n    const data = each.dataGetter(c)\n    return !data || !data.length ? map : (data.reduce ? data : ('' + data).split(',')).reduce((m, d, index) => {\n      c.$[each.itemId] = d\n      c.$[each.itemId + 'Index'] = index\n      const id = `${uid}-$${d.id || index}`\n      return resolve(m, c, { type, tag, props, subs, uid: id, iff })\n    }, map)\n  }\n  const ctor = type(c)\n  const r = {\n    owner: c,\n    tag,\n    ctor,\n    props: {},\n    key,\n    subs: subs.length ? subs.reduce((m, s) => resolve(m, c, s), new Map()) : null\n  }\n  for (let p of props) {\n    p(c, r.props)\n  }\n  return map.set((r.ctor ? r.ctor.NAME : tag) + uid, r)\n}\n\n// ==========\n// Template Compilation\n// ----------\n\nfunction compileType (tag) {\n  const dtype = tag.slice(0, 3) === 'ui:' ? tag.slice(3) : null\n  return dtype ? (dtype === 'fragment' ? c => REGISTRY.get('fragment') : c => REGISTRY.get(c.get(dtype))) : c => REGISTRY.get(tag)\n}\n\nfunction compile ({ tag, attrs, uid, subs }) {\n  const r = { uid, tag, type: compileType(tag), props: compileAttrs(attrs), key: attrs.get('ui:key') }\n\n  const aIf = attrs.get('ui:if')\n  if (aIf) {\n    r.iff = c => !!c.get(aIf)\n    if (subs.length) {\n      const ifElse = subs.find(e => e.tag === 'ui:else')\n      const ifThen = subs.find(e => e.tag === 'ui:then')\n      if (ifElse) {\n        r.iff.else = compile(ifElse).subs\n        subs = ifThen ? ifThen.subs : subs.filter(e => e !== ifElse)\n      } else if (ifThen) {\n        subs = ifThen.subs\n      }\n    }\n  }\n\n  const aEach = attrs.get('ui:each')\n  if (aEach) {\n    const [ itemId, , dataId ] = aEach.split(' ')\n    const dataGetter = dataId[0] === ':' ? c => c.app.res(dataId.slice(1)) : (c) => c.get(dataId)\n    r.each = { itemId, dataGetter }\n  }\n\n  r.subs = subs.map(compile)\n  return r\n}\n\nconst RE_SINGLE_PLACEHOLDER = /^\\{\\{([a-zA-Z0-9._$]+)\\}\\}$/\nconst RE_PLACEHOLDER = /\\{\\{([a-zA-Z0-9._$]+)\\}\\}/g\nfunction compileAttrs (attrs) {\n  const r = []\n  let aProps = null\n  attrs.forEach((v, k) => {\n    if (k.slice(0, 3) === 'ui:') {\n      if (k === 'ui:props') {\n        aProps = v\n      }\n      return\n    }\n    // localize by key\n    if (v[0] === ':') {\n      const key = v.slice(1)\n      return r.push((c, p) => { p[k] = c.app.res(key); return p })\n    }\n    if (v[0] === '<' && v[1] === '-') {\n      const ref = k + '_url'\n      const fctr = compileAttrValue(ref, v.slice(2).trim())\n      return r.push((c, p) => {\n        // custom assign\n        p['$' + k] = function () {\n          const old = this.$[ref]\n          const url = fctr(c, {})[ref]\n          if (url !== old) {\n            const ckey = k + '_counter'\n            const cbusy = k + '_busy'\n            const cerror = k + '_error'\n            const counter = (this.$[ckey] || 0) + 1\n            const cb = (error, data) => {\n              if (counter === this.$[ckey]) {\n                this.assign({[k]: data, [ref]: url, [cbusy]: false, [cerror]: error})\n              }\n            }\n            this.assign({[ref]: url, [cbusy]: true, [ckey]: counter, [cerror]: null})\n            setTimeout(() => this.app && this.app.subscribe(url, this, cb), 10)\n          }\n        }\n        return p\n      })\n    }\n    if (v[0] === '-' && v[1] === '>') {\n      const fctr = compileAttrValue(k, v.slice(2).trim())\n      return r.push((c, p) => {\n        p[k] = (data) => c.app.dispatch(fctr(c, {})[k], data)\n        return p\n      })\n    }\n\n    r.push(compileAttrValue(k, v))\n  })\n  if (aProps) {\n    const fn = compileAttrs((new Map()).set('_', aProps))[0]\n    r.push((c, p) => { fn(c, p); return p })\n  }\n  return r\n}\n\nfunction compileAttrValue (k, v) {\n  if (!v.includes('{{')) {\n    const r = v === 'true' ? true : v === 'false' ? false : v\n    return (c, p) => { p[k] = r; return p }\n  }\n  if (v.match(RE_SINGLE_PLACEHOLDER)) {\n    let key = v.slice(2, -2)\n    return (c, p) => { p[k] = c.get(key); return p }\n  }\n  return (c, p) => {\n    p[k] = v.replace(RE_PLACEHOLDER, (s, key) => {\n      const r = c.get(key)\n      return r == null ? '' : r\n    })\n    return p\n  }\n}\n\n// ==========\n// XML Parse for templates\n// ----------\n\nexport const parseXML = (function () {\n  const RE_XML_ENTITY = /&#?[0-9a-z]{3,5};/g\n  const RE_XML_COMMENT = /<!--((?!-->)[\\s\\S])*-->/g\n  const RE_ATTRS = /([a-z][a-zA-Z0-9-:]+)=\"([^\"]*)\"/g\n  const RE_ESCAPE_XML_ENTITY = /[\"'&<>]/g\n  const RE_XML_TAG = /(<)(\\/?)([a-zA-Z][a-zA-Z0-9-:]*)((?:\\s+[a-z][a-zA-Z0-9-:]+=\"[^\"]*\")*)\\s*(\\/?)>/g\n\n  const SUBST_XML_ENTITY = {\n    amp: '&',\n    gt: '>',\n    lt: '<',\n    quot: `\"`,\n    nbsp: ' '\n  }\n  const ESCAPE_XML_ENTITY = {\n    34: '&quot;',\n    38: '&amp;',\n    39: '&#39;',\n    60: '&lt;',\n    62: '&gt;'\n  }\n  const FN_ESCAPE_XML_ENTITY = m => ESCAPE_XML_ENTITY[m.charCodeAt(0)]\n  const FN_XML_ENTITY = function (_) {\n    const s = _.substring(1, _.length - 1)\n    return s[0] === '#' ? String.fromCharCode(+s.slice(1)) : (SUBST_XML_ENTITY[s] || ' ')\n  }\n  const decodeXmlEntities = (s = '') => s.replace(RE_XML_ENTITY, FN_XML_ENTITY)\n  const escapeXml = (s) => !s ? '' : ('' + s).replace(RE_ESCAPE_XML_ENTITY, FN_ESCAPE_XML_ENTITY)\n\n  let UID = 1\n\n  const parseAttrs = (s) => {\n    const r = new Map()\n    if (!s) {\n      return r\n    }\n    while (1) {\n      let e = RE_ATTRS.exec(s)\n      if (!e) {\n        return r\n      }\n      r.set(e[1], decodeXmlEntities(e[2]))\n    }\n  }\n  const stringifyAttrs = (attrs) => {\n    if (!attrs || !attrs.size) {\n      return ''\n    }\n    const r = []\n    attrs.forEach((v, k) => {\n      if (v && k !== '#text') {\n        r.push(' ' + k + '=\"' + escapeXml(v) + '\"')\n      }\n    })\n    return r.join('')\n  }\n\n  class Node {\n    constructor (tag, attrs) {\n      this.uid = UID++\n      this.tag = tag || ''\n      this.attrs = attrs || new Map()\n      this.subs = []\n    }\n    getChild (index) {\n      return this.subs[index]\n    }\n    setText (text) {\n      this.attrs.set('#text', text)\n    }\n    addChild (tag, attrs) {\n      const e = new Node(tag, attrs)\n      this.subs.push(e)\n      return e\n    }\n    toString () {\n      return stringify(this, '')\n    }\n  }\n\n  function stringify ({ tag, attrs, subs }, tab) {\n    const sattrs = stringifyAttrs(attrs)\n    const ssubs = subs.map(c => stringify(c, `  ${tab}`)).join('\\n')\n    const text = attrs.get('#text')\n    const stext = text ? `  ${tab}${escapeXml(text)}` : ''\n    return `${tab}<${tag}${sattrs}` + (!ssubs && !stext ? '/>' : `>\\n${ssubs}${stext}\\n${tab}</${tag}>`)\n  }\n\n  return (_s) => {\n    const s = ('' + _s).trim().replace(RE_XML_COMMENT, '')\n    const ctx = [new Node()]\n    let lastIndex = 0\n    // head text omitted\n    while (1) {\n      let e = RE_XML_TAG.exec(s)\n      if (!e) {\n        break\n      }\n      // preceding text\n      const text = e.index && s.slice(lastIndex, e.index)\n      if (text && text.trim()) {\n        ctx[0].addChild('#text').setText(text)\n      }\n      // closing tag\n      if (e[2]) {\n        if (ctx[0].tag !== e[3]) {\n          throw new Error(\n            'XML Parse closing tag does not match at: ' + e.index +\n            ' near ' + e.input.slice(Math.max(e.index - 15, 0), Math.min(e.index + 15, e.input.length)))\n        }\n        ctx.shift()\n      } else {\n        const elt = ctx[0].addChild(e[3], parseAttrs(e[4]))\n        // not single tag\n        if (!e[5]) {\n          ctx.unshift(elt)\n          if (ctx.length === 1) {\n            throw new Error('Parse error at: ' + e[0])\n          }\n        }\n      }\n      // up past index\n      lastIndex = RE_XML_TAG.lastIndex\n    }\n    // tail text omitted\n    return ctx[0].getChild(0)\n  }\n})()\n\n// ==========\n// Sample store\n// ----------\nfunction notify (result, cb) {\n  if (result instanceof Promise) {\n    result.then(r => cb(null, r)).catch(cb)\n  } else {\n    cb(null, result)\n  }\n}\nexport class Store {\n  constructor (defaults, R) {\n    this.R = R || {}\n    this.subscribers = new Map()\n    this.reset(defaults)\n  }\n  get (key) {\n    const getter = this['get' + key[0].toUpperCase() + key.slice(1)]\n    return getter ? getter.call(this, this.data) : key.split('.').reduce((r, k) => !r ? null : r[k], this.data)\n  }\n  assign (delta) {\n    Object.assign(this.data, delta)\n  }\n  reset (defaults) {\n    this.data = defaults || {}\n  }\n  dispatch (key, payload, cb0) {\n    const cb = (error, delta) => {\n      this.assign(error ? { error } : delta)\n      cb0(error, this.data)\n      this.subscribers.forEach(({cb, key}) => notify(this.get(key), cb))\n    }\n    try {\n      const method = this['do' + key[0].toUpperCase() + key.slice(1)]\n      const result = method.call(this, this.data, payload)\n      notify(result, cb)\n    } catch (ex) {\n      cb(ex)\n    }\n  }\n  unsubscribe (subscriberId) {\n    this.subscribers.delete(subscriberId)\n  }\n  subscribe (key, subscriberId, cb) {\n    this.subscribers.set(subscriberId, {cb, key})\n    notify(this.get(key), cb)\n  }\n\n  // resolves static resources\n  res (key) {\n    return this.R[key] || (this.R[key] = this.get(key) || key.split('_').map(s => s.slice(0, 1).toUpperCase() + s.slice(1)).join(' '))\n  }\n}\n\n// ==========\n// Sample application\n// ----------\n\nexport class Application {\n  constructor () {\n    this.store = this.createStore()\n  }\n  // hook on init\n  init () {\n    const onhash = () => this.onhashchange(window.location.hash.slice(1))\n    window.onhashchange = onhash\n    onhash()\n  }\n  createStore () {\n    throw new Error('Store is not defined')\n  }\n  dispatch (key, payload) {\n    this.store.dispatch(key, payload, (error, data) => this.assign({error}))\n  }\n  subscribe (key, subscriberId, cb) {\n    this.store.subscribe(key, subscriberId, cb)\n  }\n  unsubscribe (subscriberId) {\n    this.store.unsubscribe(subscriberId)\n  }\n  // resolves dynamic properties\n  get (key) {\n    return this.store.get(key)\n  }\n  // resolves static resources\n  res (key) {\n    return this.store.res(key)\n  }\n  onhashchange (hash) {\n    // to override\n  }\n}\n"],"sourceRoot":""}